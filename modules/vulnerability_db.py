import json

def load_vulnerability_db():
    try:
        with open("vulnerability_db.json", "r") as file:
            return json.load(file)
    except FileNotFoundError:
        print("[-] Vulnerability database not found.")
        return {}

def save_scan_profile(profile_name, profile_data):
    try:
        with open("scan_profiles.json", "r") as file:
            profiles = json.load(file)
    except FileNotFoundError:
        profiles = {}
    
    profiles[profile_name] = profile_data
    
    with open("scan_profiles.json", "w") as file:
        json.dump(profiles, file, indent=4)
    print(f"[+] Profile '{profile_name}' saved successfully.")

def load_scan_profile(profile_name):
    try:
        with open("scan_profiles.json", "r") as file:
            profiles = json.load(file)
        return profiles.get(profile_name, None)
    except FileNotFoundError:
        print("[-] No scan profiles found.")
        return None
